Автоматизований CI/CD пайплайн з використанням AWS, Terraform, Ansible та Jenkins
=================================================================================

Вступ
-----

Цей проект демонструє налаштування повністю автоматизованого CI/CD пайплайну за допомогою Terraform, Ansible та Jenkins на інстансі AWS EC2. Пайплайн створено з використанням Terraform для резервування ресурсів AWS, Ansible для конфігурації цих ресурсів та Jenkins для оркестрації процесу розгортання. В цьому наборі включено сервер Jenkins (створений за допомогою терраформ з локального комп'ютера) на AWS EC2, з якого запускаються Terraform та Ansible для розгортання та конфігурації сервера додатків також на AWS EC2.

Передумови
----------

-   Аккаунт AWS з доступом до EC2, VPC та IAM.
-   Terraform встановлено на вашому локальному комп'ютері.
-   Git встановлено на вашому локальному комп'ютері для контролю версій.

Процес налаштування
-------------------

### Крок 1: Розгортання сервера Jenkins за допомогою Terraform

Наша конфігурація включає в себе налаштування мережі, безпеки, та сервера Jenkins. За допомогою процесу provisioning, ми встановлюємо Ansible на сервер Jenkins із файлу ansible/install.sh. 
Після встановлення Ansible, скрипт запускає Ansible playbook, який встановлює всі залежності для Jenkins (Java, ключ, репозиторій, Terraform). Додатково, у playbook ми змінюємо конфігурацію 
Jenkins, щоб скасувати початкове налаштування, потім ми знаходимо початковий пароль Jenkins і використовуємо його для завантаження Jenkins CLI. За допомогою CLI ми встановлюємо потрібні плагіни. 
Також, у playbook ми передаємо файл конфігурації пайплайну jenkins/jenkins-casc для використання плагіна configuration as code. На жаль, файл може не бути розгорнутий автоматично, але ми можемо 
вказати шлях до нього (/var/lib/jenkins/casc_configs) у користувацькому інтерфейсі.

1.  Ініціалізація Terraform:

    Перейдіть до директорії вашого проекту Terraform та ініціалізуйте середовище Terraform.

    ```bash
    terraform init
    ```

2.  Планування інфраструктури:

    Перегляньте план виконання Terraform, щоб побачити ресурси, які Terraform створить/керуватиме.

    ```bash
    terraform plan
    ```

3.  Застосування конфігурації Terraform:

    Застосуйте конфігурацію Terraform, щоб почати резервування ресурсів AWS, включаючи сервер Jenkins.

    ```bash
    terraform apply
    ```

### Крок 3: Налаштування пайплайнів Jenkins

Пайплайни заздалегідь визначені в файлі jenkins-casc.yaml. Для простоти ми використовуємо один й той самий репозиторій
для усіх (не бажано), але вказуємо на розташування Jenkinsfile в директоріях, специфічних для кожного пайплайну.

1.  Пайплайн розгортання за допомогою Terraform:

    Цей пайплайн створює новий VPC та сервер додатків для застосунку. Використовується динамічні дані для наслідування групи безпеки сервера Jenkins. 
    Ми перехоплюємо IP нового серверу і зберігаємо як env variable для використання в інших пайплайнах.

2.  Пайплайн розгортання Ansible:

    Цей пайплайн конфігурує сервер додатків ansible.

3.  Пайплайн розгортання додатку:

    Нарешті, цей пайплайн автоматично розгортає додаток на сервері додатків, використовуючи вихідні дані з попередніх пайплайнів і ansible playbook.